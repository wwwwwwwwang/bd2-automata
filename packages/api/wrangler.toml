name = "bd2-automata-api"
main = "src/index.ts"
compatibility_date = "2024-05-12"

# Cron 触发器，每分钟执行一次
[triggers]
crons = ["* * * * *"]

# 绑定 D1 数据库
[[d1_databases]]
binding = "DB" # 在代码中通过 env.DB 访问
database_name = "bd2-automata-db"
database_id = "<YOUR_DATABASE_ID>" # 在创建 D1 数据库后，需要在这里填入实际的 ID

# 绑定 Consumer Worker，使其可以被 API Worker 唤醒
[[services]]
binding = "CONSUMER"
service = "bd2-automata-consumer"

# 绑定 KV 命名空间用于缓存
[[kv_namespaces]]
binding = "PERMISSION_CACHE" # 在代码中通过 env.PERMISSION_CACHE 访问
id = "<YOUR_KV_NAMESPACE_ID>" # 需要在 Cloudflare Dashboard 创建后填入
preview_id = "<YOUR_KV_NAMESPACE_PREVIEW_ID>" # 用于本地开发的 preview_id

# Secrets (通过 wrangler secret put 设置，不要写在此文件中)
# - JWT_SECRET: JWT 签名密钥
# - RESEND_API_KEY: Resend 邮件服务 API 密钥
